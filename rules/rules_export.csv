file,id,title,description,type,appliesTo,severity,tags,serviceName,expectedStatus,command,expected,path,operator
./rules\CPM\CPM-001_CPMScannerServiceRunning.json,CPM-001,CPM_Scanner_Running,CyberArk Central Policy Manager Scanner must be running.,service,CPM,critical,"cpm,service",CyberArk Central Policy Manager Scanner,Running,,,,
./rules\CPM\CPM-002_CPMServiceRunning.json,CPM-002,CPM_PasswordManager_Running,CyberArk Password Manager service must be running on the CPM server.,service,CPM,critical,"cpm,service",CyberArk Password Manager,Running,,,,
./rules\CPM\CPM-003_CPMServiceAutomaticStartup.json,CPM-003,CPM_PasswordManager_Start_Type_Automatic,CyberArk Password Manager service should start automatically,service,CPM,high,cpm,CyberArk Central Policy Manager,Running,,,,
./rules\CPM\CPM-004_CredFileHardening.json,CPM-004,CPM_CredFileHardening,Credential File Hardening,command,CPM,high,"cpm,file",,,Test-Path 'C:/Program Files (x86)/CyberArk/Password Manager/Temp/credfile',False,,
./rules\CPM\CPM-005_EnableFIPSCryptography.json,CPM-002,CPM_EnableFIPSCryptography,CPM Enable FIPS Cryptography,registry,CPM,high,"cpm,fips",,,,{'Enabled': 1},HKLM:/SYSTEM/CurrentControlSet/Control/Lsa/FIPSAlgorithmPolicy,eq
./rules\CPM\CPM-006_DisableDEPForExecutables.json,CPM-006,CPM_DisableDEPForExecutables,CPM Disable DEP For Executables,command,CPM,medium,"cpm,dep",,,(Get-ProcessMitigation -System).DEP.Enable,False,,
./rules\CPM\CPM-007_PasswordManagerUserNoExpiration.json,CPM-007,PasswordManagerUser_NoExpiration,PasswordManagerUser must not expire,command,CPM,high,"cpm,account",,,(Get-LocalUser -Name 'PasswordManagerUser').PasswordExpires -eq $false,True,,
./rules\CPM\CPM-008_LogsDirectoryHardened.json,CPM-008,Logs_Directory_Hardened,CPM Logs directory must be restricted,command,CPM,high,"cpm,filesystem",,,(Get-Acl 'C:/Program Files (x86)/CyberArk/Password Manager/Logs').AccessToString -notmatch 'Everyone',True,,
./rules\CPM\CPM-009_CPMScannerAutomaticStartup.json,CPM-009,CPMScanner_AutomaticStartup,CPM Scanner StartType must be Automatic,command,CPM,high,"cpm,service",,,(Get-Service 'CyberArk Central Policy Manager Scanner').StartType -eq 'Automatic',True,,
./rules\PSM\PSM-001_PSMServiceRunning.json,PSM-001,PSM_PrivilegedSessionManager_Running,Cyber-Ark Privileged Session Manager must be running.,service,PSM,critical,"psm,service",Cyber-Ark Privileged Session Manager,Running,,,,
./rules\PSM\PSM-002_RDCServiceRunning.json,PSM-002,PSM_RemoteDesktopConfiguration_Running,Remote Desktop Configuration service must be running on the PSM.,service,PSM,high,"psm,service,rdp",Remote Desktop Configuration,Running,,,,
./rules\PSM\PSM-003_RDMServiceRunning.json,PSM-003,PSM_RemoteDesktopManagement_Running,Remote Desktop Management must be running on the PSM.,service,PSM,high,"psm,service,rdp",Remote Desktop Management,Running,,,,
./rules\PSM\PSM-004_RDSServiceRunning.json,PSM-004,PSM_RemoteDesktopServices_Running,Remote Desktop Services must be running on the PSM.,service,PSM,critical,"psm,service,rdp",Remote Desktop Services,Running,,,,
./rules\PSM\PSM-005_RACMServiceRunning.json,PSM-005,PSM_RemoteAppConnectionManagement_Running,RemoteApp and Desktop Connection Management must be running on the PSM.,service,PSM,medium,"psm,service,rdp",RemoteApp and Desktop Connection Management,Running,,,,
./rules\PSM\PSM-006_RunApplocker.json,PSM-006,RunApplocker,Check up AppLocker Rules,command,PSM,high,"psm,applocker",,,(Get-AppLockerPolicy -Effective -Xml -ErrorAction SilentlyContinue) -ne $null,True,,
./rules\PSM\PSM-007_ConfigureOutOfDomainPSMServer.json,PSM-007,ConfigureOutOfDomainPSMServer,Configure Out Of Domain PSM Server,command,PSM,medium,"psm,domain",,,-not (Get-WmiObject Win32_ComputerSystem).PartOfDomain,True,,
./rules\PSM\PSM-008_DisableTheScreenSaverForThePSMLocalUsers.json,PSM-008,DisableTheScreenSaverForThePSMLocalUsers,Disable ScreenSaver for PSM Local users,command,PSM,low,"psm,ux",,,(Get-ItemProperty -Path 'HKU:/.DEFAULT/Control Panel/Desktop' -ErrorAction SilentlyContinue).ScreenSaveActive -eq '0',True,,
./rules\PSM\PSM-009_HidePSMDrives.json,PSM-009,HidePSMDrives,Hide PSM Drives,command,PSM,medium,"psm,policy",,,(Get-ItemProperty 'HKLM:/SOFTWARE/Microsoft/Windows/CurrentVersion/Policies/Explorer' -ErrorAction SilentlyContinue).NoDrives -ne $null,True,,
./rules\PSM\PSM-010_BlockIETools.json,PSM-010,BlockIETools,Block IE Developer Tools and Context menu,command,PSM,medium,"psm,browser",,,(Get-ItemProperty 'HKLM:/SOFTWARE/Policies/Microsoft/Internet Explorer/Restrictions' -ErrorAction SilentlyContinue).NoBrowserContextMenu -eq 1,True,,
./rules\PSM\PSM-011_HardenRDS.json,PSM-011,HardenRDS,Harden Remote Desktop Services,command,PSM,high,"psm,rdp",,,(Get-ItemProperty 'HKLM:/SYSTEM/CurrentControlSet/Control/Terminal Server/WinStations/RDP-Tcp' -ErrorAction SilentlyContinue).UserAuthentication -eq 1,True,,
./rules\PSM\PSM-012_HardenPSMUsersAccess.json,PSM-012,HardenPSMUsersAccess,Harden PSM Users Access,command,PSM,high,"psm,acl",,,(Get-Acl 'C:/Program Files/CyberArk/PSM').AccessToString -notmatch 'Everyone',True,,
./rules\PSM\PSM-013_HardenSMBServices.json,PSM-013,HardenSMBServices,Harden SMB and XB Services,command,PSM,high,"psm,smb",,,(Get-SmbServerConfiguration).EnableSMB1Protocol -eq $false,True,,
./rules\PSM\PSM-014_CredFileHardening.json,PSM-014,PSM_CredFileHardening,Credential File Hardening,command,PSM,high,"psm,file",,,(Get-Acl 'C:/Program Files/CyberArk/PSM/credfile').AccessToString -notmatch 'Everyone',True,,
./rules\PSM\PSM-015_DisableClipboardRedirection.json,PSM-015,Disable RDP clipboard redirection,Clipboard redirection should be disabled on PSM hosts,registry,PSM,high,"psm,rdp",,,,{'DisableClipboardRedirection': 1},HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services,eq
./rules\PSM\PSM-016_ConfigureUsersForPSMSessions.json,PSM-016,ConfigureUsersForPSMSessions,Configure users for PSM sessions,command,PSM,medium,"psm,users",,,[bool](Get-LocalGroupMember -Group 'PSMConnect' -ErrorAction SilentlyContinue),True,,
./rules\PSM\PSM-017_PSMForWebApplications.json,PSM-017,PSMForWebApplications,PSM for web applications,command,PSM,low,"psm,web",,,Test-Path 'C:/Program Files/CyberArk/PSMWebApp',True,,
./rules\PSM\PSM-018_EnableUsersToPrintPSMSessions.json,PSM-018,EnableUsersToPrintPSMSessions,Enable users to print PSM sessions,command,PSM,low,"psm,policy",,,(Get-ItemProperty 'HKLM:/SOFTWARE/CyberArk/PSM').AllowPrint -ne 1,True,,
./rules\PSM\PSM-019_SupportWebApplications.json,PSM-019,SupportWebApplications,Support Web Applications on PSM,command,PSM,low,"psm,web",,,Test-Path 'C:/Program Files/CyberArk/PSM/Components/Web',True,,
./rules\PSM\PSM-020_ClearRemoteDesktopUsers.json,PSM-020,ClearRemoteDesktopUsers,Clear Remote Desktop Users group from PSM Server,command,PSM,high,"psm,rdp",,,(Get-LocalGroupMember -Group 'Remote Desktop Users' -ErrorAction SilentlyContinue | Measure).Count -eq 0,True,,
./rules\PSM\PSM-021_PSMConnectExists.json,PSM-021,PSMConnect_User_Exists,PSMConnect account should exist on PSM,command,PSM,high,"psm,account",,,[bool](Get-LocalUser -Name 'PSMConnect' -ErrorAction SilentlyContinue),True,,eq
./rules\PSM\PSM-022_PSMAdminConnectExists.json,PSM-022,PSMAdminConnect_Exists,PSMAdminConnect user must exist,command,PSM,high,"psm,account",,,[bool](Get-LocalUser -Name 'PSMAdminConnect' -ErrorAction SilentlyContinue),True,,
./rules\PSM\PSM-023_DFSSDisabled.json,PSM-023,DFSS_Disabled,DFSS scheduling must be disabled,registry,PSM,medium,"psm,performance",,,,{'EnableCpuQuota': 0},HKLM:/SYSTEM/CurrentControlSet/Control/Session Manager/Quota System,
./rules\PSM\PSM-024_DisconnectedSessionTime1min.json,PSM-024,DisconnectedSessionTime_1min,Disconnected sessions must end after 1 min,registry,PSM,medium,"psm,rdp",,,,{'MaxDisconnectionTime': 60000},HKLM:/SOFTWARE/Policies/Microsoft/Windows NT/Terminal Services,
./rules\PSM\PSM-025_ReconnectionPolicyOriginOnly.json,PSM-025,ReconnectionPolicy_OriginOnly,Reconnection must be from originating client only,registry,PSM,medium,"psm,rdp",,,,{'fReconnectSame': 1},HKLM:/SOFTWARE/Policies/Microsoft/Windows NT/Terminal Services,
./rules\PSM\PSM-026_AppLockerStrict.json,PSM-026,AppLocker_Strict,AppLocker must be strict,command,PSM,high,"psm,applocker",,,(Get-AppLockerPolicy -Effective).RuleCollections[0].Rules.Count -gt 0,True,,
./rules\PVWA\PVWA-001_ScheduledTasksServiceRunning.json,PVWA-001,PVWA_ScheduledTasks_Running,CyberArk Scheduled Tasks service must be running on the PVWA server.,service,PVWA,high,"pvwa,service",CyberArk Scheduled Tasks,Running,,,,
./rules\PVWA\PVWA-002_WASServiceRunning.json,PVWA-002,PVWA_WAS_Running,Windows Process Activation Service must be running on the PVWA server.,service,PVWA,critical,"pvwa,iis,service",Windows Process Activation Service,Running,,,,
./rules\PVWA\PVWA-003_W3SVCServiceRunning.json,PVWA-003,PVWA_W3SVC_Running,World Wide Web Publishing Service must be running on the PVWA server.,service,PVWA,critical,"pvwa,iis,service",World Wide Web Publishing Service,Running,,,,
./rules\PVWA\PVWA-004_IIS_MimeTypes.json,PVWA-004,PVWA_IIS_MimeTypes,PVWA IIS MimeTypes,command,PVWA,low,"pvwa,iis,mime",,,(Get-WebConfigurationProperty -pspath 'IIS:/Sites' -filter system.webServer/staticContent -name .).Collection.Count -ge 0,True,,
./rules\PVWA\PVWA-005_AnonymousAuthentication.json,PVWA-005,PVWA_AnonymousAuthentication,PVWA IIS Anonymous Authentication,command,PVWA,high,"pvwa,iis,auth",,,(Get-WebConfigurationProperty -Filter 'system.webServer/security/authentication/anonymousAuthentication' -PSPath 'IIS:/Sites' -Name enabled).Value -eq $false,True,,
./rules\PVWA\PVWA-006_DirectoryBrowsing.json,PVWA-006,PVWA_DirectoryBrowsing,PVWA IIS Directory Browsing,command,PVWA,high,"pvwa,iis",,,(Get-WebConfigurationProperty -Filter 'system.webServer/directoryBrowse' -PSPath 'IIS:/Sites' -Name enabled).Value -eq $false,True,,
./rules\PVWA\PVWA-007_IIS_SSL_TLS_Settings.json,PVWA-007,PVWA_IIS_SSL_TLS_Settings,PVWA IIS SSL TLS Settings,command,PVWA,critical,"pvwa,iis,tls",,,(Get-WebBinding -Name 'PasswordVault' -Protocol https | Measure).Count -ge 1,True,,
./rules\PVWA\PVWA-008_IIS_Cypher_Suites.json,PVWA-008,PVWA_IIS_Cypher_Suites,PVWA IIS Cypher Suites,command,PVWA,critical,"pvwa,cipher",,,(Get-TlsCipherSuite | Where-Object {$_.Name -like 'TLS_RSA_*'} | Measure).Count -eq 0,True,,
./rules\PVWA\PVWA-009_Scheduled_Task_Service_LocalUser.json,PVWA-009,PVWA_Scheduled_Task_Service_LocalUser,PVWA Scheduled Task Service LocalUser,command,PVWA,medium,"pvwa,task",,,[bool](Get-ScheduledTask -TaskName 'CyberArk PVWA Maintenance' -ErrorAction SilentlyContinue),True,,
./rules\PVWA\PVWA-010_NonSystemDrive.json,PVWA-010,PVWA_NonSystemDrive,PVWA not installed on System drive,command,PVWA,medium,"pvwa,filesystem",,,(Get-Item 'C:/inetpub/wwwroot/PasswordVault').PSPath -notlike 'C:*',True,,
./rules\PVWA\PVWA-011_IIS_Hardening.json,PVWA-011,PVWA_IIS_Hardening,PVWA IIS Hardening,command,PVWA,medium,"pvwa,iis,hardening",,,(Get-WebConfigurationProperty -Filter 'system.webServer/security/requestFiltering' -PSPath 'IIS:/Sites' -Name .) -ne $null,True,,
./rules\PVWA\PVWA-012_AdditionalAppPool.json,PVWA-012,PVWA_AdditionalAppPool,PVWA Application Pool configuration,command,PVWA,high,"pvwa,iis,apppool",,,(Get-WebAppPoolState -Name 'PVWAAppPool').Value -eq 'Started',True,,
./rules\PVWA\PVWA-013_CredFileHardening.json,PVWA-013,PVWA_CredFileHardening,Credential File Hardening,command,PVWA,high,"pvwa,file",,,(Get-Acl 'C:/inetpub/wwwroot/PasswordVault/Web.config').AccessToString -notmatch 'Everyone',True,,
./rules\PVWA\PVWA-014_IIS_Registry_Shares.json,PVWA-014,PVWA_IIS_Registry_Shares,PVWA IIS Registry Shares,command,PVWA,medium,"pvwa,shares",,,(Get-ItemProperty 'HKLM:/SYSTEM/CurrentControlSet/Services/LanmanServer/Parameters' -ErrorAction SilentlyContinue).AutoShareServer -ne 1,True,,
./rules\PVWA\PVWA-015_IIS_WebDAV.json,PVWA-015,PVWA_IIS_WebDAV,PVWA IIS WebDAV,command,PVWA,high,"pvwa,iis,webdav",,,-not (Get-WindowsFeature Web-DAV-Publishing).Installed,True,,
./rules\PVWA\PVWA-016_Cryptography_Settings.json,PVWA-016,PVWA_Cryptography_Settings,PVWA Cryptography Mode Settings,command,PVWA,high,"pvwa,tls",,,(Get-TlsCipherSuite | Where-Object {$_.Name -like '*TLS_RSA_*'} | Measure).Count -eq 0,True,,
./rules\PVWA\PVWA-017_AppPoolRunning.json,PVWA-017,PVWA_AppPool_Running,PVWA application pool should be started,iisAppPool,PVWA,high,"pvwa,iis",,Started,,,,
./rules\PVWA\PVWA-018_HTTPSBinding.json,PVWA-018,PVWA_HTTPS_Binding_Present,PVWA site must expose HTTPS binding,iisBinding,PVWA,critical,"pvwa,tls,iis",,,,True,,
./rules\PVWA\PVWA-019_IISInstalled.json,PVWA-019,IIS_Role_Installed,IIS Web-Server should be installed on PVWA hosts,command,PVWA,high,"pvwa,iis",,,(Get-WindowsFeature -Name Web-Server).Installed,True,,eq
./rules\PVWA\PVWA-020_HTTPSPortOpenLocally.json,PVWA-020,PVWA_HTTPS_Port_Open_Locally,Localhost should listen on 443 for PVWA,port,PVWA,medium,"pvwa,tls,port",,,,True,,
./rules\PVWA\PVWA-021_NoHTTPBinding.json,PVWA-021,No_HTTP_Binding,PVWA must not expose HTTP binding,command,PVWA,critical,"pvwa,iis,tls",,,(Get-WebBinding -Name 'PasswordVault' -Protocol http | Measure).Count -eq 0,True,,
./rules\PVWA\PVWA-022_AppPoolNoManagedCode.json,PVWA-022,AppPool_NoManagedCode,PVWA AppPool must run with No Managed Code,command,PVWA,high,"pvwa,iis",,,(Get-WebAppPool -Name 'PVWAAppPool').managedRuntimeVersion -eq '',True,,
./rules\PVWA\PVWA-023_AppPoolIdleTimeoutDisabled.json,PVWA-023,AppPool_IdleTimeout_Disabled,PVWA AppPool IdleTimeout must be disabled,command,PVWA,medium,"pvwa,iis",,,(Get-WebConfiguration /system.applicationHost/applicationPools/add[@name='PVWAAppPool'] | Select -ExpandProperty processModel).idleTimeout.TotalMinutes -eq 0,True,,
./rules\PVWA\PVWA-024_DisableDynamicCompression.json,PVWA-024,Disable_DynamicCompression,Dynamic compression must be disabled,command,PVWA,medium,"pvwa,iis,compression",,,(Get-WebConfigurationProperty 'system.webServer/httpCompression' 'IIS:' -Name dynamicCompressionEnable).Value -eq $false,True,,
./rules\VAULT\VAULT-001_ENEServiceRunning.json,VAULT-001,Vault_EventNotificationEngine_Running,Cyber-Ark Event Notification Engine must be running on the Vault server.,service,Vault,high,"vault,service",Cyber-Ark Event Notification Engine,Running,,,,
./rules\VAULT\VAULT-002_StaticIP.json,VAULT-002,Vault_StaticIP,Check that the Vault has Static IP,command,Vault,critical,"vault,network",,,(Get-NetIPInterface | Where-Object {$_.Dhcp -eq 'Disabled'} | Measure).Count -gt 0,True,,
./rules\VAULT\VAULT-003_WindowsFirewall.json,VAULT-003,Vault_WindowsFirewall,Check that the Vault has the Firewall active,command,Vault,critical,"vault,firewall",,,(Get-NetFirewallProfile -Profile Domain).Enabled,True,,
./rules\VAULT\VAULT-004_DomainJoined.json,VAULT-004,Vault_DomainJoined,Check that the Vault was not joined to a Domain,command,Vault,critical,"vault,isolation",,,-not (Get-WmiObject Win32_ComputerSystem).PartOfDomain,True,,
./rules\VAULT\VAULT-005_LogicContainerServiceLocalUser.json,VAULT-005,Vault_LogicContainerServiceLocalUser,Vault Logic Container Service LocalUser,command,Vault,high,"vault,account",,,[bool](Get-LocalUser -Name 'LogicContainer' -ErrorAction SilentlyContinue),True,,
./rules\VAULT\VAULT-006_FirewallNonStandardRules.json,VAULT-006,Vault_FirewallNonStandardRules,Vault Firewall Rule,command,Vault,medium,"vault,firewall,rules",,,(Get-NetFirewallRule -ErrorAction SilentlyContinue | Where-Object {$_.Enabled -eq 'True'} | Measure).Count -ge 1,True,,
./rules\VAULT\VAULT-007_ServerCertificate.json,VAULT-007,Vault_ServerCertificate,Vault Server Certificate,command,Vault,high,"vault,cert",,,(Get-ChildItem Cert:/LocalMachine/My | Measure).Count -ge 1,True,,
./rules\VAULT\VAULT-008_NICHardening.json,VAULT-008,Vault_NICHardening,Network Interface Configuration Hardening,command,Vault,high,"vault,network",,,(Get-NetAdapterAdvancedProperty -ErrorAction SilentlyContinue | Measure).Count -ge 0,True,,
./rules\WINDOWS\WIN-001_ImportingINFConfiguration.json,WIN-001,ImportingINFConfiguration,Importing an INF File to the Local Machine,command,Windows,medium,"cross,inf",,,Test-Path C:/Windows/inf/hardening.inf,True,,
./rules\WINDOWS\WIN-002_ValidateServerRoles.json,WIN-002,ValidateServerRoles,This function checks for unnecessary roles,command,Windows,medium,"cross,roles",,,"(Get-WindowsFeature | Where-Object {$_.InstallState -eq 'Installed' -and $_.Name -in @('Fax','XPS-Viewer')}).Count -eq 0",True,,
./rules\WINDOWS\WIN-003_EnableScreenSaver.json,WIN-003,EnableScreenSaver,Checks if the screen saver is disabled,command,Windows,low,"cross,ux",,,-not (Get-ItemProperty -Path 'HKCU:Control Panel/Desktop' -Name ScreenSaveActive -ErrorAction SilentlyContinue).ScreenSaveActive,True,,
./rules\WINDOWS\WIN-004_AdvancedAuditPolicyConfiguration.json,WIN-004,AdvancedAuditPolicyConfiguration,Advanced Audit Policy Configuration,command,Windows,high,"cross,audit",,,(auditpol /get /category:* | Select-String 'Account Logon').Length -gt 0,True,,
./rules\WINDOWS\WIN-005_RemoteDesktopServices.json,WIN-005,RemoteDesktopServices,Check Remote Desktop Services settings,command,Windows,high,"cross,rdp",,,(Get-ItemProperty -Path 'HKLM:SOFTWARE/Microsoft/Windows NT/CurrentVersion/Winlogon').RDPAutoLogon -eq $null,True,,
./rules\WINDOWS\WIN-006_EventLogSizeAndRetention.json,WIN-006,EventLogSizeAndRetention,Check Event Log and Retention settings,command,Windows,medium,"cross,eventlog",,,"(@('Security','System','Application') | % { (Get-WinEvent -ListLog $_).MaximumSizeInBytes -ge 20971520 }).Count -eq 3",True,,
./rules\WINDOWS\WIN-007_RegistryAudits.json,WIN-007,RegistryAudits,Check Registry Audits access control,command,Windows,medium,"cross,registry,audit",,,(auditpol /get /subcategory:'Registry' | Select-String 'Success and Failure') -ne $null,True,,
./rules\WINDOWS\WIN-008_RegistryPermissions.json,WIN-008,RegistryPermissions,Check Registry permissions,command,Windows,medium,"cross,registry,acl",,,([string](Get-Acl 'HKLM:SOFTWARE').AccessToString) -notmatch 'Everyone',True,,
./rules\WINDOWS\WIN-009_FileSystemPermissions.json,WIN-009,FileSystemPermissions,Validates unnecessary permissions on %SystemRoot%/System32/Config and %SystemRoot%/System32/Config/RegBack.,command,Windows,high,"cross,filesystem,acl",,,"(@('C:/Windows/System32/Config','C:/Windows/System32/Config/RegBack') | % { (Get-Acl $_).AccessToString -notmatch 'Everyone' }) -notcontains $false",True,,
./rules\WINDOWS\WIN-010_FileSystemAudit.json,WIN-010,FileSystemAudit,Check audit access rules on %SystemRoot%/System32/Config and %SystemRoot%/System32/Config/RegBack.,command,Windows,medium,"cross,filesystem,audit",,,"(@('C:/Windows/System32/Config','C:/Windows/System32/Config/RegBack') | % { (Get-Acl $_).AuditToString -match 'Success' }) -notcontains $false",True,,
./rules\WINDOWS\WIN-011_DisableServiceRRAS.json,WIN-011,DisableService_RRAS,Ensure service 'Routing and Remote Access' is Disabled/Stopped,service,Windows,high,"cross,services",Routing and Remote Access,Stopped,,,,
./rules\WINDOWS\WIN-012_DisableServiceSCARDSVR.json,WIN-012,DisableService_SCARDSVR,Ensure service 'Smart Card' is Disabled/Stopped,service,Windows,high,"cross,services",Smart Card,Stopped,,,,
./rules\WINDOWS\WIN-013_DisableServiceSCPolicySvc.json,WIN-013,DisableService_SCPolicySvc,Ensure service 'Smart Card Removal Policy' is Disabled/Stopped,service,Windows,high,"cross,services",Smart Card Removal Policy,Stopped,,,,
./rules\WINDOWS\WIN-014_DisableServiceSNMPTRAP.json,WIN-014,DisableService_SNMPTRAP,Ensure service 'SNMP Trap' is Disabled/Stopped,service,Windows,high,"cross,services",SNMP Trap,Stopped,,,,
./rules\WINDOWS\WIN-015_DisableServiceSACSVR.json,WIN-015,DisableService_SACSVR,Ensure service 'Special Administration Console Helper' is Disabled/Stopped,service,Windows,high,"cross,services",Special Administration Console Helper,Stopped,,,,
./rules\WINDOWS\WIN-016_DisableServiceWerSvc.json,WIN-016,DisableService_WerSvc,Ensure service 'Windows Error Reporting Service' is Disabled/Stopped,service,Windows,high,"cross,services",Windows Error Reporting Service,Stopped,,,,
./rules\WINDOWS\WIN-017_DisableServiceWinHttpAutoProxySvc.json,WIN-017,DisableService_WinHttpAutoProxySvc,Ensure service 'WinHTTP Web Proxy Auto-Discovery Service' is Disabled/Stopped,service,Windows,high,"cross,services",WinHTTP Web Proxy Auto-Discovery Service,Stopped,,,,
./rules\WINDOWS\WIN-018_TLS1-2Enabled.json,WIN-018,TLS_1-2_Enabled,Ensure TLS 1.2 is enabled (server),registry,Windows,high,"tls,schannel",,,,{'Enabled': 1},HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\TLS 1.2\Server,eq
./rules\WINDOWS\WIN-019_TLS1Disabled.json,WIN-019,TLS_1-0_Disabled,Disable TLS 1.0 (server),registry,Windows,high,"tls,schannel",,,,"{'Enabled': 0, 'DisabledByDefault': 1}",HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\TLS 1.0\Server,eq
./rules\WINDOWS\WIN-020_PowerShellVersion5+.json,WIN-020,PowerShell >= 5,Minimum PSVersion 5,command,Windows,medium,runtime,,,$PSVersionTable.PSVersion.Major,5,,ge
./rules\WINDOWS\WIN-021_WindowsFirewallDomainEnabled.json,WIN-021,Windows Firewall (Domain) enabled,Domain profile should be enabled,command,Windows,low,firewall,,,(Get-NetFirewallProfile -Profile Domain).Enabled,True,,eq
./rules\WINDOWS\WIN-022_NLAEnabled.json,WIN-022,RDP_Requires_NLA,NLA must be enabled for RDP,registry,"Windows,PSM",high,"rdp,nla",,,,{'UserAuthentication': 1},HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp,eq
./rules\WINDOWS\WIN-023_RDPEncryptionLevel.json,WIN-023,RDP encryption level >= 3,Ensure strong RDP encryption,registry,"Windows,PSM",high,rdp,,,,{'MinEncryptionLevel': 3},HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services,ge
./rules\WINDOWS\WIN-024_SMBv1Disabled.json,WIN-008,SMBv1 disabled,Disable SMBv1 server component,registry,Windows,high,smb,,,,{'SMB1': 0},HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters,eq
./rules\WINDOWS\WIN-025_UACEnabled.json,WIN-025,UAC enabled,Enable User Account Control,registry,Windows,medium,uac,,,,{'EnableLUA': 1},HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System,eq
